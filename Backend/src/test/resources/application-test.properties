# Test profile configuration
# This configuration is used when running tests with @ActiveProfiles("test")

# Database configuration - will be overridden by Testcontainers
spring.datasource.url=jdbc:h2:mem:testdb
spring.datasource.driver-class-name=org.h2.Driver
spring.datasource.username=sa
spring.datasource.password=

# JPA/Hibernate configuration for tests
spring.jpa.hibernate.ddl-auto=create-drop
spring.jpa.show-sql=true
spring.jpa.properties.hibernate.format_sql=true
spring.jpa.database-platform=org.hibernate.dialect.H2Dialect

# Disable Flyway for tests (we use create-drop instead)
spring.flyway.enabled=false

# Logging configuration for tests
logging.level.org.springframework.web=DEBUG
logging.level.org.springframework.security=DEBUG
logging.level.org.testcontainers=INFO
logging.level.com.sebastianhamm.Backend=DEBUG
logging.level.org.hibernate.SQL=DEBUG
logging.level.org.hibernate.type.descriptor.sql.BasicBinder=TRACE

# Disable security auto-configuration for tests
spring.autoconfigure.exclude=org.springframework.boot.autoconfigure.security.servlet.SecurityAutoConfiguration

# Test Auth0 properties to satisfy validation
auth0.domain=https://test.auth0.com/
auth0.audience=https://api.test.com/
auth0.issuer-uri=https://test.auth0.com/

# Mail configuration for tests (use mock)
spring.mail.host=localhost
spring.mail.port=25
spring.mail.username=
spring.mail.password=
spring.mail.properties.mail.smtp.auth=false
spring.mail.properties.mail.smtp.starttls.enable=false

# Actuator configuration for tests
management.endpoints.web.exposure.include=health,info,metrics
management.endpoint.health.show-details=always

# Test-specific application properties
app.environment=test
app.debug.enabled=true
app.cors.allowed-origins=http://localhost:3000,http://localhost:8080
app.cors.allowed-methods=GET,POST,PUT,DELETE,OPTIONS
app.cors.allowed-headers=*
app.cors.allow-credentials=true
app.cors.max-age=3600
app.rate-limit.enabled=false
app.rate-limit.requests-per-minute=1000
app.upload.max-file-size=10MB
app.upload.allowed-types=image/jpeg,image/png,image/gif,application/pdf
app.upload.path=target/test-uploads

# Override environment variables for tests
SPRING_DATASOURCE_URL=jdbc:h2:mem:testdb
SPRING_DATASOURCE_USERNAME=sa
SPRING_DATASOURCE_PASSWORD=
APP_CORS_ALLOWED_ORIGINS=http://localhost:3000,http://localhost:8080